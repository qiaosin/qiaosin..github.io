import{d as w,p as A,A as $,q as R,s as _,t as B,G as N,o as v,c as h,v as l,x as p,j as n,b as c,H as S,M as i,D as V,_ as b}from"./index-00852b3b.js";import{F as z,I as Z}from"./Info-1c52b512.js";import"./index-8528fd74.js";import"./castArray-01677f3a.js";import"./event-fe80fd0c.js";import"./index-a38f9e5d.js";const M={class:"user-form"},q={class:"user-form-title"},j={class:"user-form-title2"},G={class:"user-form-title2-p"},H=w({__name:"ResetForm",setup(C){const{t:o,locale:d}=A(),x=$(),m=()=>{const e=localStorage.getItem("ahab_email_time");if(e){let s=Math.floor((+e+6e4-new Date().getTime())/1e3);if(s>0){a.value.email.buttonText=`${s}s`,a.value.email.buttonDisabled=!0;const r=setInterval(()=>{if(s<=1){clearInterval(r),a.value.email.buttonText=o("login.sendVfcCode"),a.value.email.buttonDisabled=!1;return}a.value.email.buttonText=`${--s}s`},1e3)}}},t=R({email:"",verificationCode:"",password:"",confirmPassword:""}),E=async()=>{try{console.log("send code"),localStorage.setItem("ahab_email_time",""+new Date().getTime()),m();const e=await V({email:t.email});console.log(e,"===res"),e.statusCode===200?i.toast("验证码发送成功！"):i.error(e.message)}catch(e){i.error(e.message||e.data.message)}},P=e=>{console.log("blur",e),e&&/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$/.test(e)?a.value.email.buttonDisabled=!1:a.value.email.buttonDisabled=!0},u=()=>({email:{placeholder:o("login.email"),onBlur:P,withButton:!0,buttonText:o("login.sendVfcCode"),buttonDisabled:!0,buttonClick:E},verificationCode:{placeholder:o("login.verificationCode")},password:{placeholder:o("login.password"),type:"password"},confirmPassword:{placeholder:o("login.confirmPassword"),type:"password"}}),a=_(u());m();const f=()=>({verificationCode:[{required:!0,message:o("login.vfcCodeNull"),trigger:"blur"}],email:[{required:!0,message:o("login.emailNull"),trigger:"blur"},{type:"email",message:o("login.emailError"),trigger:"blur"}],password:[{validator:T(),trigger:"blur"}],confirmPassword:[{validator:F(),trigger:"blur"}]}),y=/^(?![a-zA-Z]+$)(?!\d+$)(?![^\da-zA-Z\s]+$).{6,12}$/,T=()=>(e,s,r)=>{try{s===""?r(new Error(o("login.passwordNull"))):y.test(s)?(t.confirmPassword!==t.password&&r(new Error(o("login.confirmPasswordError"))),r()):r(new Error(o("login.passwordInvalid")))}catch(I){console.log(I)}},F=()=>(e,s,r)=>{s===""?r(new Error(o("login.confirmPasswordNull"))):s!==t.password?r(new Error(o("login.confirmPasswordError"))):r()},g=_(f()),D=async()=>{try{const e=await S({email:t.email,code:t.verificationCode,password:t.password});console.log(e,"===res"),e.statusCode===200?(i.success(o("login.resetSuccess")),x.push("login")):i.error(e.message)}catch(e){i.error(e.message||e.data.message)}};return B(d,()=>{g.value=f(),a.value=u()}),N(()=>{}),(e,s)=>(v(),h("div",M,[l("div",q,p(n(o)("login.findAccount")),1),l("div",j,[l("p",G,p(n(o)("login.findTips")),1)]),c(z,{ruleForm:t,"onUpdate:ruleForm":s[0]||(s[0]=r=>t=r),formConfig:a.value,rules:g.value,confirmText:n(o)("confirm"),resetText:n(o)("reset"),showReset:!1,onSubmit:D},null,8,["ruleForm","formConfig","rules","confirmText","resetText"])]))}});const U=b(H,[["__scopeId","data-v-93c1d3fa"]]),J={class:"user-main"},K=w({__name:"ForgetPwd",setup(C){return(o,d)=>(v(),h("div",J,[c(Z,{class:"user-main-info"}),c(U,{class:"user-main-form"})]))}});const k=b(K,[["__scopeId","data-v-3870ef62"]]);export{k as default};
//# sourceMappingURL=ForgetPwd-9563d6c7.js.map
