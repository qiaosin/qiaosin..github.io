import{d as _,p as P,A as F,q as R,s as f,t as $,o as p,c as w,v as A,x as N,j as n,b as l,C as B,M as i,D as V,_ as v}from"./index-00852b3b.js";import{F as z,I as S}from"./Info-1c52b512.js";import"./index-8528fd74.js";import"./castArray-01677f3a.js";import"./event-fe80fd0c.js";import"./index-a38f9e5d.js";const Z={class:"user-form"},q={class:"user-form-title"},M=_({__name:"RegisterForm",setup(b){const{t:r,locale:m}=P(),h=F(),C=/^(?![a-zA-Z]+$)(?!\d+$)(?![^\da-zA-Z\s]+$).{6,12}$/,c=()=>{const e=localStorage.getItem("ahab_email_time");if(e){let o=Math.floor((+e+6e4-new Date().getTime())/1e3);if(o>0){a.value.email.buttonText=`${o}s`,a.value.email.buttonDisabled=!0;const s=setInterval(()=>{if(o<=1){clearInterval(s),a.value.email.buttonText=r("login.sendVfcCode"),a.value.email.buttonDisabled=!1;return}a.value.email.buttonText=`${--o}s`},1e3)}}},t=R({name:"",email:"",verificationCode:"",password:"",confirmPassword:""}),x=async()=>{try{console.log("send code"),localStorage.setItem("ahab_email_time",""+new Date().getTime()),c();const e=await V({email:t.email});console.log(e,"===res"),e.statusCode===200?i.toast("验证码发送成功！"):i.error(e.message)}catch(e){i.error(e.message||e.data.message)}},E=e=>{console.log("blur",e),e&&/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$/.test(e)?a.value.email.buttonDisabled=!1:a.value.email.buttonDisabled=!0},d=()=>({name:{placeholder:r("login.userName")},email:{placeholder:r("login.email"),onBlur:E,withButton:!0,buttonText:r("login.sendVfcCode"),buttonDisabled:!0,buttonClick:x},verificationCode:{placeholder:r("login.verificationCode")},password:{placeholder:r("login.password"),type:"password"},confirmPassword:{placeholder:r("login.confirmPassword"),type:"password"}}),a=f(d());c();const y=()=>(e,o,s)=>{try{o===""?s(new Error(r("login.passwordNull"))):C.test(o)?(t.confirmPassword!==t.password&&s(new Error(r("login.confirmPasswordError"))),s()):s(new Error(r("login.passwordInvalid")))}catch(I){console.log(I)}},T=()=>(e,o,s)=>{o===""?s(new Error(r("login.confirmPasswordNull"))):o!==t.password?s(new Error(r("login.confirmPasswordError"))):s()},u=()=>({verificationCode:[{required:!0,message:r("login.vfcCodeNull"),trigger:"blur"}],email:[{required:!0,message:r("login.emailNull"),trigger:"blur"},{type:"email",message:r("login.emailError"),trigger:"blur"}],name:[{required:!0,message:r("login.nameNull"),trigger:"blur"}],password:[{validator:y(),trigger:"blur"}],confirmPassword:[{validator:T(),trigger:"blur"}]}),g=f(u()),D=async()=>{try{const e=await B({nickname:t.name,email:t.email,password:t.password,code:t.verificationCode});console.log(e,"===res"),e.statusCode===200?(i.toast("注册成功！"),h.push("login")):i.error(e.message)}catch(e){i.error(e.message||e.data.message)}};return $(m,()=>{g.value=u(),a.value=d()}),(e,o)=>(p(),w("div",Z,[A("div",q,N(n(r)("login.register")),1),l(z,{ruleForm:t,"onUpdate:ruleForm":o[0]||(o[0]=s=>t=s),formConfig:a.value,rules:g.value,confirmText:n(r)("confirm"),resetText:n(r)("reset"),showReset:!0,onSubmit:D},null,8,["ruleForm","formConfig","rules","confirmText","resetText"])]))}});const j=v(M,[["__scopeId","data-v-a3870f87"]]),U={class:"user-main"},G=_({__name:"Register",setup(b){return(r,m)=>(p(),w("div",U,[l(S,{class:"user-main-info"}),l(j,{class:"user-main-form"})]))}});const W=v(G,[["__scopeId","data-v-aa3b92e7"]]);export{W as default};
//# sourceMappingURL=Register-b21e055a.js.map
