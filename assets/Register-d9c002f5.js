import{d as _,p as F,A as P,q as R,s as f,t as N,o as w,c as v,v as B,x as V,j as n,b as l,C as S,M as i,D as q,_ as b}from"./index-09328375.js";import{F as $}from"./Form-17c141a0.js";import{r as p}from"./regext-6373de82.js";import{I as A}from"./Info-01055cda.js";import"./index-3c681246.js";import"./castArray-e23c1ee3.js";import"./event-fe80fd0c.js";import"./index-d37a1592.js";const M={class:"user-form"},j={class:"user-form-title"},U=_({__name:"RegisterForm",setup(h){const{t:r,locale:m}=F(),C=P(),c=()=>{const e=localStorage.getItem("ahab_email_time");if(e){let o=Math.floor((+e+6e4-new Date().getTime())/1e3);if(o>0){a.value.email.buttonText=`${o}s`,a.value.email.buttonDisabled=!0;const s=setInterval(()=>{if(o<=1){clearInterval(s),a.value.email.buttonText=r("login.sendVfcCode"),a.value.email.buttonDisabled=!1;return}a.value.email.buttonText=`${--o}s`},1e3)}}},t=R({name:"",email:"",verificationCode:"",password:"",confirmPassword:""}),x=async()=>{try{console.log("send code"),localStorage.setItem("ahab_email_time",""+new Date().getTime()),c();const e=await q({email:t.email});console.log(e,"===res"),e.statusCode===200?i.toast("验证码发送成功！"):i.error(e.message)}catch(e){i.error(e.message||e.data.message)}},y=e=>{e&&p.email.test(e)?a.value.email.buttonDisabled=!1:a.value.email.buttonDisabled=!0},d=()=>({name:{placeholder:r("login.userName")},email:{placeholder:r("login.email"),onBlur:y,withButton:!0,buttonText:r("login.sendVfcCode"),buttonDisabled:!0,buttonClick:x},verificationCode:{placeholder:r("login.verificationCode")},password:{placeholder:r("login.password"),type:"password"},confirmPassword:{placeholder:r("login.confirmPassword"),type:"password"}}),a=f(d());c();const T=()=>(e,o,s)=>{try{o===""?s(new Error(r("login.passwordNull"))):p.password.test(o)?(t.confirmPassword,t.password,s()):s(new Error(r("login.passwordInvalid")))}catch(I){console.log(I)}},E=()=>(e,o,s)=>{o===""?s(new Error(r("login.confirmPasswordNull"))):o!==t.password?s(new Error(r("login.confirmPasswordError"))):s()},u=()=>({verificationCode:[{required:!0,message:r("login.vfcCodeNull"),trigger:"blur"}],email:[{required:!0,message:r("login.emailNull"),trigger:"blur"},{type:"email",message:r("login.emailError"),trigger:"blur"}],name:[{required:!0,message:r("login.nameNull"),trigger:"blur"},{min:2,max:20,message:r("login.nameError"),trigger:"blur"}],password:[{validator:T(),trigger:"blur"}],confirmPassword:[{validator:E(),trigger:"blur"}]}),g=f(u()),D=async()=>{try{const e=await S({nickname:t.name,email:t.email,password:t.password,code:t.verificationCode});console.log(e,"===res"),e.statusCode===200?(i.toast("注册成功！"),C.push("login")):i.error(e.message)}catch(e){i.error(e.message||e.data.message)}};return N(m,()=>{g.value=u(),a.value=d()}),(e,o)=>(w(),v("div",M,[B("div",j,V(n(r)("login.register")),1),l($,{ruleForm:t,"onUpdate:ruleForm":o[0]||(o[0]=s=>t=s),formConfig:a.value,rules:g.value,confirmText:n(r)("confirm"),resetText:n(r)("reset"),showReset:!0,onSubmit:D},null,8,["ruleForm","formConfig","rules","confirmText","resetText"])]))}});const k=b(U,[["__scopeId","data-v-3cfabd9e"]]),z={class:"user-main"},G=_({__name:"Register",setup(h){return(r,m)=>(w(),v("div",z,[l(A,{class:"user-main-info"}),l(k,{class:"user-main-form"})]))}});const Y=b(G,[["__scopeId","data-v-aa3b92e7"]]);export{Y as default};
//# sourceMappingURL=Register-d9c002f5.js.map
