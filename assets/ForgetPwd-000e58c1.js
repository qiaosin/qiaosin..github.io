import{d as v,p as R,A as B,q as N,s as _,t as S,G as V,o as b,c as h,v as l,x as p,j as n,b as d,H as A,M as i,D as M,_ as C}from"./index-09328375.js";import{F as $}from"./Form-17c141a0.js";import{r as w}from"./regext-6373de82.js";import{I as q}from"./Info-01055cda.js";import"./index-3c681246.js";import"./castArray-e23c1ee3.js";import"./event-fe80fd0c.js";import"./index-d37a1592.js";const j={class:"user-form"},G={class:"user-form-title"},H={class:"user-form-title2"},U={class:"user-form-title2-p"},z=v({__name:"ResetForm",setup(x){const{t:o,locale:c}=R(),y=B(),m=()=>{const e=localStorage.getItem("ahab_email_time");if(e){let s=Math.floor((+e+6e4-new Date().getTime())/1e3);if(s>0){a.value.email.buttonText=`${s}s`,a.value.email.buttonDisabled=!0;const r=setInterval(()=>{if(s<=1){clearInterval(r),a.value.email.buttonText=o("login.sendVfcCode"),a.value.email.buttonDisabled=!1;return}a.value.email.buttonText=`${--s}s`},1e3)}}},t=N({email:"",verificationCode:"",password:"",confirmPassword:""}),P=async()=>{try{console.log("send code"),localStorage.setItem("ahab_email_time",""+new Date().getTime()),m();const e=await M({email:t.email});console.log(e,"===res"),e.statusCode===200?i.toast("验证码发送成功！"):i.error(e.message)}catch(e){i.error(e.message||e.data.message)}},T=e=>{console.log("blur",e),e&&w.email.test(e)?a.value.email.buttonDisabled=!1:a.value.email.buttonDisabled=!0},u=()=>({email:{placeholder:o("login.email"),onBlur:T,withButton:!0,buttonText:o("login.sendVfcCode"),buttonDisabled:!0,buttonClick:P},verificationCode:{placeholder:o("login.verificationCode")},password:{placeholder:o("login.password"),type:"password"},confirmPassword:{placeholder:o("login.confirmPassword"),type:"password"}}),a=_(u());m();const f=()=>({verificationCode:[{required:!0,message:o("login.vfcCodeNull"),trigger:"blur"}],email:[{required:!0,message:o("login.emailNull"),trigger:"blur"},{type:"email",message:o("login.emailError"),trigger:"blur"}],password:[{validator:F(),trigger:"blur"}],confirmPassword:[{validator:D(),trigger:"blur"}]}),F=()=>(e,s,r)=>{try{s===""?r(new Error(o("login.passwordNull"))):w.password.test(s)?(t.confirmPassword,t.password,r()):r(new Error(o("login.passwordInvalid")))}catch(I){console.log(I)}},D=()=>(e,s,r)=>{s===""?r(new Error(o("login.confirmPasswordNull"))):s!==t.password?r(new Error(o("login.confirmPasswordError"))):r()},g=_(f()),E=async()=>{try{const e=await A({email:t.email,code:t.verificationCode,password:t.password});console.log(e,"===res"),e.statusCode===200?(i.success(o("login.resetSuccess")),y.push("login")):i.error(e.message)}catch(e){i.error(e.message||e.data.message)}};return S(c,()=>{g.value=f(),a.value=u()}),V(()=>{}),(e,s)=>(b(),h("div",j,[l("div",G,p(n(o)("login.findAccount")),1),l("div",H,[l("p",U,p(n(o)("login.findTips")),1)]),d($,{ruleForm:t,"onUpdate:ruleForm":s[0]||(s[0]=r=>t=r),formConfig:a.value,rules:g.value,confirmText:n(o)("confirm"),resetText:n(o)("reset"),showReset:!1,onSubmit:E},null,8,["ruleForm","formConfig","rules","confirmText","resetText"])]))}});const J=C(z,[["__scopeId","data-v-583943dd"]]),K={class:"user-main"},L=v({__name:"ForgetPwd",setup(x){return(o,c)=>(b(),h("div",K,[d(q,{class:"user-main-info"}),d(J,{class:"user-main-form"})]))}});const oe=C(L,[["__scopeId","data-v-3870ef62"]]);export{oe as default};
//# sourceMappingURL=ForgetPwd-000e58c1.js.map
